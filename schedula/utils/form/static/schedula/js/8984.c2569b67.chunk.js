"use strict";(self.webpackChunkschedula_form=self.webpackChunkschedula_form||[]).push([[8984],{73817:(e,t,l)=>{l.d(t,{Z:()=>n});const n=function(e,t){const l=new Blob([JSON.stringify(e)],{type:"text/json"}),n=document.createElement("a");n.download=t,n.href=window.URL.createObjectURL(l);const o=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});n.dispatchEvent(o),n.remove()}},338:(e,t,l)=>{l.d(t,{Z:()=>n});const n=(e,t)=>{if(t.preventDefault(),t.target.files.length){const l=new FileReader;l.onload=async t=>{let{target:l}=t;e(JSON.parse(l.result))},l.readAsText(t.target.files[0]),t.target.value=null}}},8984:(e,t,l)=>{l.r(t),l.d(t,{default:()=>ae});var n=l(72791),o=l(20938),a=l(2458),s=l(82622),r=l(96008),i=l(14988),c=l(15787),u=l(84791),d=l(6314),h=l(65323),m=l(92365),p=l(72351),g=l(55035),f=l(68944),x=l(91515),b=l(23605),j=l(30142),y=l(25671),Z=l(83388),C=l(83099),S=l(45863),w=l(49998),k=l(61431),v=l(36864),B=l(55076),D=l(87309),P=l(78792),T=l(91082),N=l(72131),E=l(73817),I=l(338),L=l(71861),M=l(58121),z=l.n(M),F=l(20659),R=l(14101),A=l.n(R);const U=(e,t)=>(t.forEach((t=>(0,L.applyChange)(e,null,t))),e),K=(e,t)=>(e=e.filter(((e,l)=>{let[n,o]=e;return 0===l||n<=t}))).slice(1).reduce(((e,t)=>{let[l,n]=t;return U(e,n)}),z()(e[0][1])),O=(e,t)=>{let l=A()(t,{algorithm:"sha1",encoding:"base64"}),{lastHash:n,changes:o}=(e=>{let t=window.sessionStorage.getItem(e)||"",l=t.slice(28);return l=l?F.ZP.decompress.fromString(l):[],{lastHash:t.slice(0,28),changes:l}})(e);return n===l&&(o=o.slice(0,o.length-1)),{changes:o,diffList:o.map((e=>{let[t,n,o]=e;return{date:t,sameAsCurrent:l===o}})).reverse()}};var H=l(3111),$=l(85152),J=l(79745),V=l(37481),W=l(66364),_=l.n(W),Y=l(78958),q=l(80184);const G=n.lazy((()=>Promise.all([l.e(2320),l.e(9003)]).then(l.bind(l,59817)))),Q=n.lazy((()=>Promise.all([l.e(1583),l.e(7828),l.e(4596)]).then(l.bind(l,74596)))),X=n.lazy((()=>Promise.all([l.e(1583),l.e(4569)]).then(l.bind(l,84569)))),ee=n.lazy((()=>Promise.all([l.e(7828),l.e(1177)]).then(l.bind(l,11177)))),{Header:te,Content:le,Footer:ne,Sider:oe}=y.Z,ae=e=>{let{children:t,render:l,savingData:M=!1,savingKey:R,items:W=[],defaultSelectedKeys:ae=["0"],urlContact:se,languages:re,logo:ie,userProps:ce,cloudUrl:ue,hideRun:de=!1,hideDebug:he=!1,hideClean:me=!1,hideFullscreen:pe=!1,hideFiles:ge=!1,hideSideMenu:fe=!1,footer:xe=null,theme:be="light",contentProps:je,...ye}=e;const{getLocale:Ze}=(0,V.useLocaleStore)(),Ce=Ze("App"),Se=(0,n.useRef)(null),{formContext:we}=l,{form:ke}=we,{userInfo:ve={}}=ke.state,Be=!_()(ve),[De,{isEnabled:Pe,toggleFullscreen:Te}]=(0,N.Z)(ke.formElement),Ne=R||(l?"schedula-"+ke.props.$id+"-"+l.idSchema.$id+"-formData":"form"),[Ee,Ie]=(0,n.useState)(M),{formData:Le}=l,[Me,ze]=(0,n.useState)(!1),[Fe,Re]=(0,n.useState)(null);(0,n.useEffect)((function(){if(Ee)try{((e,t)=>{let l=A()(t,{algorithm:"sha1",encoding:"base64"}),n=window.sessionStorage.getItem(e)||"";if(n.slice(0,28)!==l){let o,a=n.slice(28);a=a?F.ZP.decompress.fromString(a):[];let s=Math.floor(Date.now()/6e4);if(a=a.filter(((e,t)=>{let[l,n]=e;return l<s})),a.length){if(o=(0,L.diff)(a.slice(1).reduce(((e,t)=>{let[l,n]=t;return U(e,n)}),z()(a[0][1])),t),!o)return}else o=t;a.push([s,o,l]),window.sessionStorage.setItem(e,"".concat(l).concat(F.ZP.compress.toString(a)))}})(Ne,Le)}catch(e){Ie(!1),ke.props.notify({message:Ce.autoSavingErrorTitle,description:e.message,type:"warning"})}}),[Ne,Le,Ee,Ce.autoSavingErrorTitle]);const{changes:Ae,diffList:Ue}=(0,n.useMemo)((function(){return Me?O(Ne,Le):{}}),[Ne,Le,Me]),Ke=(0,n.useMemo)((function(){return null!==Fe&&Ae?K(Ae,Fe):null}),[Ae,Fe]),Oe=e=>(e.href&&"string"===typeof e.label&&(e.label=(0,q.jsx)("a",{href:e.href,children:e.label})),e.children&&(e.children=e.children.map(Oe)),e),He=W.map(Oe),[$e,Je]=(0,n.useState)(ae[0]),[Ve,We]=(0,n.useState)(!1),[_e,Ye]=(0,n.useState)(!1),[qe,Ge]=(0,n.useState)(null);return(0,n.useEffect)((()=>{!Be&&qe&&Ge(null)}),[Be,qe]),"number"===typeof xe&&(xe=t[xe]),(0,q.jsxs)(y.Z,{style:{height:"100%"},...ye,children:[qe||se||re||ce||He.length||ie?(0,q.jsx)(te,{className:"ant-menu-".concat(be),style:{position:"sticky",top:0,zIndex:1,width:"100%",padding:0},children:(0,q.jsxs)("div",{style:{display:"flex"},children:[(0,q.jsx)("div",{style:{height:32,margin:16,textAlign:"center",lineHeight:"normal"},children:ie?(0,Y.R$)({key:"logo",layout:ie,render:l,isArray:!1}):null},"logo"),He.length?(0,q.jsx)(Z.Z,{theme:be,mode:"horizontal",style:{flex:"auto",minWidth:0},defaultSelectedKeys:ae,items:He,onSelect:e=>{let{key:t}=e;Je(t)},...ye},"left-menu"):(0,q.jsx)("div",{style:{flex:"auto",minWidth:0}}),qe||se||re||ce?(0,q.jsxs)(C.Z,{style:{paddingLeft:"16px",paddingRight:"16px",cursor:"pointer"},children:[qe?(0,q.jsxs)(S.Z.Text,{keyboard:!0,children:["# ",qe.id," - ",qe.name]}):null,se?(0,q.jsx)(ee,{form:ke,formContext:we,urlContact:se}):null,re?(0,q.jsx)(X,{form:ke,languages:re}):null,ce?(0,q.jsx)(Q,{form:ke,...ce}):null]},"right-element"):null]})}):null,(0,q.jsxs)(y.Z,{children:[fe||de&&he&&me&&pe&&!ue&&ge&&!M?null:(0,q.jsxs)(oe,{collapsible:!0,defaultCollapsed:!0,style:{overflowY:"auto",marginBottom:"48px"},theme:be,children:[(0,q.jsx)("input",{ref:Se,accept:["json"],type:"file",hidden:!0,onChange:e=>{(0,I.Z)(l.parent.props.onChange,e)}}),(0,q.jsx)(Z.Z,{mode:"inline",theme:be,selectable:!1,onClick:e=>{let{key:t}=e;"run"===t?ke.submit():"debug"===t?ke.onSubmit(null,{headers:{Debug:"true"}}):"clean"===t?w.Z.confirm({title:Ce.cleanConfirm,onOk(){l.parent.props.onChange({})},onCancel(){}}):"fullscreen"===t?Te():"download"===t?(0,E.Z)(l.formData,"file.json"):"upload"===t?Se.current.click():"autosave"===t?Ie(!Ee):"restore"===t?ze(!Me):"cloud-download"===t?We(!0):"cloud-upload"===t&&Ye(!0)},items:[de?null:{icon:(0,q.jsx)(o.Z,{}),key:ke.state.runnable?"run":"no-run",className:"run-button",disabled:!ke.state.runnable,label:Ce.runButton},he?null:{icon:(0,q.jsx)(a.Z,{}),key:ke.state.debuggable?"debug":"no-debug",className:"debug-button",disabled:!ke.state.debuggable,label:Ce.debugButton},me?null:{icon:(0,q.jsx)(s.Z,{}),key:"clean",className:"clean-button",label:Ce.cleanButton},!pe&&Pe?{icon:De?(0,q.jsx)(r.Z,{}):(0,q.jsx)(i.Z,{}),className:"fullscreen-button",key:"fullscreen",label:(0,q.jsx)(k.Z,{title:De?Ce.disableFullscreen:Ce.enableFullscreen,placement:"right",children:Ce.fullscreenButton})}:null,Be&&ue?{icon:(0,q.jsx)(c.Z,{}),key:"cloud",className:"cloud-button",label:Ce.cloudButton,children:[{icon:(0,q.jsx)(u.Z,{}),key:"cloud-download",className:"cloud-download-button",label:(0,q.jsx)(k.Z,{title:Ce.cloudDownloadTooltip,placement:"right",children:Ce.cloudDownloadButton})},{icon:(0,q.jsx)(d.Z,{}),key:"cloud-upload",className:"cloud-upload-button",label:(0,q.jsx)(k.Z,{title:Ce.cloudUploadTooltip,placement:"right",children:Ce.cloudUploadButton})}]}:null,ge?null:{icon:(0,q.jsx)(h.Z,{}),key:"files",className:"files-button",label:Ce.filesButton,children:[{icon:(0,q.jsx)(m.Z,{}),key:"download",className:"download-button",label:(0,q.jsx)(k.Z,{title:Ce.downloadTooltip,placement:"right",children:Ce.downloadButton})},{icon:(0,q.jsx)(p.Z,{}),key:"upload",className:"upload-button",label:(0,q.jsx)(k.Z,{title:Ce.uploadTooltip,placement:"right",children:Ce.uploadButton})}]},M?{icon:(0,q.jsx)(g.Z,{}),key:"branches",className:"branches-button",label:Ce.branchesButton,children:[{icon:Ee?(0,q.jsx)(f.Z,{}):(0,q.jsx)(x.Z,{}),key:"autosave",className:"autosave-button",label:(0,q.jsx)(k.Z,{title:Ee?Ce.autoSavingTooltip:Ce.autoSaveTooltip,placement:"right",children:Ee?Ce.autoSavingButton:Ce.autoSaveButton})},{icon:(0,q.jsx)(b.Z,{}),key:"restore",className:"restore-button",label:(0,q.jsx)(k.Z,{title:Ce.restoreTooltip,placement:"right",children:Ce.restoreButton})}]}:null].filter((e=>null!==e))})]}),(0,q.jsxs)(y.Z,{children:[(0,q.jsxs)(le,{style:{margin:"16px 16px"},...je,children:[He.length?(0,q.jsx)(v.Z,{activeKey:String($e),items:t.map(((e,t)=>({key:String(t),children:e,style:{height:"100%"}}))),renderTabBar:()=>null,style:{height:"100%"}}):t,(0,q.jsx)(B.Z.BackTop,{}),ue?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(H.Z,{uiSchema:{"ui:cloudUrl":ue,"ui:modal":{open:Ve,onCancel:()=>{We(!1)}},"ui:currentKey":qe,"ui:onSelect":e=>{We(!1),Ge(e)}},formData:ke.state.formData,onChange:ke.onChange,formContext:l.formContext}),(0,q.jsx)($.Z,{uiSchema:{"ui:cloudUrl":ue,"ui:currentKey":qe,"ui:onSave":e=>{Ye(!1),Ge(e)},"ui:modal":{open:_e,onCancel:()=>{Ye(!1)}}},formData:ke.state.formData,onChange:ke.onChange,formContext:l.formContext})]}):null,(0,q.jsx)(J.My,{title:Ce.restoreModalTitle,open:Me,onOk:()=>{ze(!1)},onCancel:()=>{ze(!1)},footer:[(0,q.jsx)(D.ZP,{onClick:()=>{ze(!1),(e=>{window.sessionStorage.removeItem(e)})(Ne)},children:Ce.restoreEraseButton},"erase"),(0,q.jsx)(D.ZP,{onClick:()=>{ze(!1)},children:Ce.restoreCloseButton},"close")],children:(0,q.jsx)(P.ZP,{size:"small",dataSource:Ue,renderItem:e=>(0,q.jsxs)(P.ZP.Item,{children:[(0,q.jsx)(P.ZP.Item.Meta,{avatar:(0,q.jsx)(T.Z,{title:Ce.restoreConfirm,placement:"top",onConfirm:t=>{t&&t.preventDefault(),l.parent.props.onChange(K(Ae,e.date)),ze(!1)},children:(0,q.jsx)(D.ZP,{type:"primary",shape:"circle",icon:(0,q.jsx)(b.Z,{})})}),title:new Date(6e4*e.date).toLocaleString()}),e.sameAsCurrent?null:(0,q.jsx)(k.Z,{title:Ce.restoreDifferences,placement:"bottom",children:(0,q.jsx)(D.ZP,{type:"primary",shape:"circle",icon:(0,q.jsx)(j.Z,{}),onClick:()=>{Re(e.date)}})})]})})}),(0,q.jsx)(J.My,{title:Ce.restoreTitleDifferences,open:null!==Fe,onCancel:()=>{Re(null)},footer:[(0,q.jsx)(D.ZP,{onClick:()=>{ze(!1),l.parent.props.onChange(Ke),Re(null)},children:Ce.restoreRestoreButton},"restore"),(0,q.jsx)(D.ZP,{onClick:()=>{Re(null)},children:Ce.restoreCloseButton},"close")],children:Fe?(0,q.jsx)(G,{rightTitle:new Date(6e4*Math.floor(Date.now()/6e4)).toLocaleString()+" (".concat(Ce.restoreCurrent,")"),leftTitle:new Date(6e4*Fe).toLocaleString(),oldValue:Ke,newValue:Le}):null})]}),xe?(0,q.jsx)(ne,{style:{position:"sticky",bottom:0,zIndex:1,width:"100%",padding:"16px 50px",textAlign:"center"},children:xe}):null]})]})]})}}}]);
//# sourceMappingURL=8984.c2569b67.chunk.js.map