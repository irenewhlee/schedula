"use strict";(self.webpackChunkschedula_form=self.webpackChunkschedula_form||[]).push([[1357],{21357:(e,o,t)=>{t.r(o),t.d(o,{default:()=>U});var r=t(72351),n=t(61431),s=t(95562),a=t(98583),l=t(87309),c=t(11172),i=t.n(c),d=t(72791),m=t(98422),p=t(1067),u=t(60090),f=t(46401),g=t(18111),h=t.n(g),x=t(7229),w=t.n(x),v=t(37481),b=t(80184);const I="DraggableUploadList",C=e=>{let{originNode:o,moveRow:t,file:r,fileList:s,locale:a}=e;const l=(0,d.useRef)(null),c=s.indexOf(r),[{isOver:i,dropClassName:u},f]=(0,m.L)({accept:I,collect:e=>{const{index:o}=e.getItem()||{};return o===c?{}:{isOver:e.isOver(),dropClassName:o<c?" drop-over-downward":" drop-over-upward"}},drop:e=>{t(e.index,c)}}),[,g]=(0,p.c)({type:I,item:{index:c},collect:e=>({isDragging:e.isDragging()})});f(g(l));const h=(0,b.jsx)(n.Z,{title:a.errorToolTip,children:o.props.children});return(0,b.jsx)("div",{ref:l,className:"ant-upload-draggable-list-item ".concat(i?u:""),style:{cursor:"move"},children:"error"===r.status?h:o})};function R(e){let o=e.split(","),t=o[0].match(/:(.*?);/)[1],r=decodeURIComponent(o[0].match(/;?name=(.*?);/)[1]),n=atob(o[1]),s=n.length,a=new Uint8Array(s);for(;s--;)a[s]=n.charCodeAt(s);let l=new File([a],r,{type:t});return l.response=e,l.status="done",l}const U=e=>{let{multiple:o,id:t,readonly:n,disabled:c,onChange:m,value:p,schema:g,options:x,rawErrors:I}=e;const{getLocale:U}=(0,v.useLocaleStore)(),L=U("FileWidget"),[j,y]=(0,d.useState)((p?o?p:[p]:[]).filter((e=>!!e)).map(R));let N=j.length;(0,d.useEffect)((()=>{if(!j.some((e=>"uploading"===e.status))){let e=j.filter((e=>"done"===e.status)).map((e=>e.response)),t=(p?o?p:[p]:[]).filter((e=>!!e));h()(t,e)||m(o?e:e[0])}}),[j,o,m,p]);const O=(0,d.useCallback)(((e,o)=>{const t=j[e];y(i()(j,{$splice:[[e,1],[o,0,t]]}))}),[j,y]);let D={onRemove:e=>{const o=j.indexOf(e),t=j.slice();t.splice(o,1),y(t)},beforeUpload:e=>{let o=e.name.split("."),t=o[o.length-1].toLowerCase(),r=!(x.accept&&x.accept.length)||x.accept.some((e=>t===e));if(r)if(g.maxItems&&N>=g.maxItems){if(r=!1,N===g.maxItems){const e=g.maxItems;s.Z.error({message:L.errorNotUploaded,description:g.maxItems>1?w()(L.errorMaxItems,{maxItems:e}):L.errorOnlyOneItem,placement:"top"}),N++}}else j.some((o=>o.name===e.name))&&(s.Z.error({message:L.errorNotUploaded,description:w()(L.errorSameFile,{filename:e.name}),placement:"top"}),r=!1);else{const e=x.accept.map((e=>e.toUpperCase())).join("/");s.Z.error({message:L.errorNotUploaded,description:w()(L.errorFileType,{fileTypes:e}),placement:"top"})}return r&&N++,r||a.Z.LIST_IGNORE},onDownload:e=>{const o=document.createElement("a");o.download=e.name,o.href=e.response;const t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});o.dispatchEvent(t),o.remove()},onChange:e=>{"done"===e.file.status&&y((o=>{const t=o.map((e=>e.uid)).indexOf(e.file.uid),r=o.slice();return r[t]=e.file,r}))},customRequest:async e=>{let{onProgress:o,onError:t,onSuccess:r,file:n}=e;const s=new FileReader;return s.readAsDataURL(n),s.onload=()=>{let e=s.result.replace(";base64",";name=".concat(encodeURIComponent(n.name),";base64"));r(e)},s.onerror=e=>t(e),s.onprogress=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),o(e)},y((e=>[...e,n])),{abort(){s.abort()}}},showUploadList:{showDownloadIcon:!0,showRemoveIcon:!(n||c)},multiple:!!o,fileList:j};return x.accept&&(D.accept=".".concat(x.accept.join(",."))),o?(D.itemRender=(e,o,t)=>(0,b.jsx)(C,{locale:L,originNode:e,file:o,fileList:t,moveRow:O}),g.maxItems&&(D.maxCount=g.maxItems)):D.maxCount=1,(0,b.jsx)(u.W,{backend:f.PD,children:(0,b.jsx)(a.Z,{...D,children:n||c?null:(0,b.jsx)(l.ZP,{icon:(0,b.jsx)(r.Z,{}),danger:!!I,children:L.dropMessage},t+"-Button")},t+"-Upload")},t+"-DndProvider")}}}]);
//# sourceMappingURL=1357.fe32f1d1.chunk.js.map